function setAutocomplete(){$("#destinations").bind("keydown",function(t){t.keyCode===$.ui.keyCode.TAB&&$(this).data("autocomplete").menu.active&&t.preventDefault()}).autocomplete({minLength:1,autoFocus:!0,source:function(t,e){var a=$.ui.autocomplete.escapeRegex(t.term),i=new RegExp("^"+a,"i"),n=$.grep(GLOBALS[0],function(t){return i.test(t[1])});e(n)},focus:function(){return!1},select:function(t,e){return $("#destinations").val(e.item[1]),!1}}).data("autocomplete")._renderItem=function(e,a){return t="<span style='*float:left; *width:60%'>"+a[1]+"</span>",t=t+"<span style='float:right;*float:left; *width:32%;*display:inline;*text-align: right;'>"+getRegion(a[2],a[3])+"</span>",$("<li></li>").data("item.autocomplete",a).append("<a>"+t+"</a>").appendTo(e)},$("#destinations").autocomplete("widget").removeClass("ui-corner-all")}function initSearchBox(){$("#destinations").val()==$("#destinations").attr("alt")&&($("#destinations").css("color","#808080"),$("#destinations").css("font-style","italic"))}function get_des_selected_ids(){if(""==$("#destinations").val()||$("#destinations").val()==$("#destinations").attr("alt"))return null;var t=$("#destinations").val();t=$.trim(t);for(var e=new Array,a=GLOBALS[0],i=0,n=0;n<a.length;++n)""!=t&&""!=a[n][1]&&$.trim(a[n][1])==t&&(e[i]=a[n][0],i++);return e}function searchfield_focus(t){t.value==$(t).attr("alt")&&(t.value="",t.style.color="",t.style.fontStyle="")}function searchfield_blur(t){""==t.value&&(t.value=$(t).attr("alt"),t.style.color="#808080",t.style.fontStyle="italic")}function split(t){return t.split(/,\s*/)}function extractLast(t){return split(t).pop()}function check_travel_date(t,e){var a=new Date,i=t.split("-"),n=new Date(a.getFullYear(),a.getMonth(),a.getDate()),o=new Date(parseInt(i[2],10),[parseInt(i[1],10)-1],parseInt(i[0],10));n>=o&&alert(e)}function getSearchParams(){var t="destination="+$("#destinations").val()+"&departure_date="+$("#departure_date").val(),e=getSelectedTravelStyles();""!=e&&(t=t+"&travel_styles="+e),t=t+"&duration="+$("#duration option:selected").text(),t=t+"&group="+$("#group_type").val();var a=getSelectedClassServices();return""!=a&&(t=t+"&class_sv="+a),$("#tour_type").attr("checked")&&(t+="&tour_type=private"),t}function getSelectedClassServices(){var t="";return $("input[name^='class_service']:checked").each(function(){t=t+$(this).attr("alt")+":"}),""!=t&&(t=t.substring(0,t.length-1)),t}function initDate(t,e,a,i,n,o,r,s,l){void 0==o&&(o=""),void 0==r&&(r=""),void 0==s&&(s="");var c=e.split("-"),d="";if(""!=s&&"undefined"!=typeof c[1]){var p=parseInt(c[0],10),h=parseInt(c[1],10),u=parseInt(c[2],10);checkDate(p,h,u,s)||(d=getNearDepartureDate(p,h,u,s),""==d&&(d=t),e=d)}if(initOptionMonth(t,e,i,s),initOptionDay(e,a,s),""!=s&&d==t){var f=$(a+" option:first").val(),_=$(i+" option:first").val();"undefined"!=typeof f&&"undefined"!=typeof _&&(e=f+"-"+_)}$(n).val(e),"undefined"!=typeof s&&""!=s&&(disabledDays=s),$(n).datepicker({showOn:"button",dateFormat:"dd-mm-yy",buttonImage:"/media/calendar.gif",buttonImageOnly:!0,duration:"",buttonText:"Pick a date to check rates",onSelect:function(t){selectDate(t,a,i,s),getDepartureDay(t,o,r),$(a).change()},beforeShowDay:function(t){return"undefined"!=typeof s&&""!=s?(sDate=t.getDate(),sMonth=t.getMonth()+1,checkDate(sDate,sMonth,t.getFullYear(),disabledDays)?[!0,""]:[!1,"","Unavailable"]):[!0,""]}}),$(n).datepicker("option",$.datepicker.regional[l]),getDepartureDay(e,o,r)}function getNearDepartureDate(t,e,a,i){for(var n="",o=new Date([e,t,a].join("/")),r=[],s=[],l=[],c=0,d=0;d<i.length;++d)for(var p=i[d][0],h=i[d][1],u=0;u<h.length;++u){var f=i[d][1][u].date;f=f.split(",");for(var _=0;_<f.length;++_){var v=[h[u].month,f[_],p].join("/");thisDate=new Date(v),curDiff=o-thisDate,l.push([c,thisDate]),curDiff<0?r.push([c,curDiff]):s.push([c,curDiff]),c++}}if(r.sort(function(t,e){return t[1]<e[1]}),s.sort(function(t,e){return t[1]>e[1]}),"undefined"!=typeof r[0]){var m=l[r[0][0]][1].getDate(),g=l[r[0][0]][1].getMonth()+1,$=l[r[0][0]][1].getFullYear();n=m+"-"+g+"-"+$}else if("undefined"!=typeof s[0]){var m=l[s[0][0]][1].getDate(),g=l[s[0][0]][1].getMonth()+1,$=l[s[0][0]][1].getFullYear();n=m+"-"+g+"-"+$}return n}function selectDate(t,e,a,i){var n=t.split("-");$.each($(a).attr("options"),function(a,o){return optarr=o.value.split("-"),parseInt(n[1],10)==parseInt(optarr[0],10)&&parseInt(n[2],10)==parseInt(optarr[1],10)?(o.selected=!0,void initOptionDay(t,e,i)):void 0})}function initOptionMonth(t,e,a,i){for(var n="",o=t.split("-"),r=e.split("-"),s=getMonthsAndYears(o[1],o[2],i),l=r[1],c=r[2],d=0;d<s.length;++d){var p=s[d].split("-"),h=p[1],u=p[0];("undefined"==typeof i||""==i||checkMonth(u,h,i))&&(n+=parseInt(l,10)==parseInt(u,10)&&c==h?'<option value="'+s[d]+'" selected="selected" >'+month_names[u-1]+", "+h+"</option>":'<option value="'+s[d]+'">'+month_names[u-1]+", "+h+"</option>")}$(a).html(n)}function initOptionDay(t,e,a){for(var i="",n=t.split("-"),o=daysInMonth(n[1],n[2]),r=0;r<o.length;++r){if("undefined"!=typeof a&&""!=a){var s=o[r].split("-");if(!checkDate(s[1],parseInt(n[1],10),n[2],a))continue}var l=o[r].split("-");i+=parseInt(l[1],10)==parseInt(n[0],10)?'<option value="'+l[1]+'" selected>'+l[0]+", "+l[1]+"</option>":'<option value="'+l[1]+'">'+l[0]+", "+l[1]+"</option>"}$(e).html(i)}function changeMonth(t,e,a,i,n,o){var r=$(e).attr("options"),s=$(t).attr("options"),l=r[r.selectedIndex].value.split("-");if("undefined"!=typeof s[s.selectedIndex]&&s.selectedIndex>-1){var c=s[s.selectedIndex].value,d=c+"-"+l[0]+"-"+l[1];initOptionDay(d,t,o),changeDay(t,e,a,i,n)}}function changeDay(t,e,a,i,n){var o=$(e).attr("options"),r=$(t).attr("options"),s=r[r.selectedIndex].value,l=o[o.selectedIndex].value.split("-");$(a).val(s+"-"+l[0]+"-"+l[1]),getDepartureDay(s+"-"+l[0]+"-"+l[1],i,n)}function changeNight(t,e,a){var i=$(e).val();getDepartureDay(i,t,a)}function show_sortlist(){$("#sortlist").show()}function hide_sortlist(){$("#sortlist").hide()}function getDepartureDay(t,e,a){if(void 0==e||""==e);else{var i="";i=parseInt($(e).val());var n=t.split("-"),o=new Date(parseInt(n[2],10),parseInt(n[1],10)-1,parseInt(n[0],10));o.setDate(o.getDate()+i);var r=month_names[o.getMonth()]+" "+o.getFullYear();r=daysofweek[o.getDay()]+" "+o.getDate()+" "+r,$(a).text(r)}}function getMonthsAndYears(t,e,a){t=parseInt(t,10),e=parseInt(e,10),""!=a&&(LIMIT_MONTH=18);var i=new Array;t_nextmonth=new Date(e,t-1,1);for(var n=0;LIMIT_MONTH>n;++n)n_month=t_nextmonth.getMonth()+1,n_year=t_nextmonth.getFullYear(),i.push(n_month+"-"+n_year),t_nextmonth.setMonth(n_month);return i}function daysInMonth(t,e){t=parseInt(t,10),e=parseInt(e,10);for(var a=new Array,i=32-new Date(e,t-1,32).getDate(),n=1;i>=n;++n)day=new Date(e,t-1,n),a.push(daysofweek[day.getDay()]+"-"+n);return a}function getRegion(t,e){return null!=e&&""!=e?e:""}function unique(t){tmpArr=new Array(0);for(var e=0;e<t.length;e++)""!=t[e]&&-1==tmpArr.indexOf(t[e])&&(tmpArr.length+=1,tmpArr[tmpArr.length-1]=t[e]);return tmpArr}function checkDate(t,e,a,i){for(var n=!1,o=0;o<i.length;++o)if("undefined"!=typeof i[o]&&""!=i&&a==i[o][0]){var r=get_index_of_month(i[o][1],e);if(r>-1){var s=i[o][1][r].date;s=s.split(",");for(var l=0;l<s.length;++l)parseInt(t,10)==parseInt(s[l],10)&&(n=!0)}}return n}function get_index_of_month(t,e){for(var a=0;a<t.length;++a)if(parseInt(t[a].month)==parseInt(e))return a;return-1}function getMonthsAndYearsCheckRates(t,e){t=parseInt(t,10),e=parseInt(e,10);var a=new Array;t_nextmonth=new Date(e,t-1,1);for(var i=0;LIMIT_MONTH>i;++i)n_month=t_nextmonth.getMonth()+1,n_year=t_nextmonth.getFullYear(),a.push(n_month+"-"+n_year),t_nextmonth.setMonth(n_month);return a}function checkMonth(t,e,a){for(var i=0;i<a.length;++i)if("undefined"!=typeof a[i]&&e==a[i][0]&&get_index_of_month(a[i][1],t)>-1)return!0;return!1}function getTomorrow(){var t=new Date,e=t.getDate(),a=t.getMonth(),i=t.getFullYear(),n=new Date(i,a,e+1);return n}function checkRoomTypeBooking(t){var e=!1;return $(".room_select_"+t).each(function(){var t=$(this).find("option:selected").val();t>0&&(e=!0)}),e}function openRoomTypeInfo(t){var e=$("#img_"+t).attr("class");return"togglelink"==e?($("#img_"+t).removeClass("togglelink"),$("#img_"+t).addClass("togglelink_open"),$("#detail_infor_"+t).show()):($("#img_"+t).removeClass("togglelink_open"),$("#img_"+t).toggleClass("togglelink"),$("#detail_infor_"+t).hide()),!1}function openExtrabedInfo(t){var e=$("#img_extra_"+t).attr("class");return"togglelink"==e?($("#img_extra_"+t).removeClass("togglelink"),$("#img_extra_"+t).addClass("togglelink_open"),$("#extra_bed_"+t+"_select").show()):($("#img_extra_"+t).removeClass("togglelink_open"),$("#img_extra_"+t).toggleClass("togglelink"),$("#extra_bed_"+t+"_select").hide()),!1}function show_hotel_detail(t,e){var a="/hotel_detail/detail/"+t;window.open(a,"_blank",e)}function addDays(t,e){return new Date(t.getTime()+24*e*60*60*1e3)}function re_arrange_cabin(t){$("#re_arrange_cabin_"+t).show(),$("#re_arrange_cabin_text_"+t).hide(),$("#re_arrange_cabin_guide_"+t).hide()}function hide_re_arrange_cabin(t){$("#re_arrange_cabin_"+t).hide(),$("#re_arrange_cabin_text_"+t).show(),$("#re_arrange_cabin_guide_"+t).show()}function change_cabin(t,e){for(var a=$("#num_cabin_"+t+" option:selected").val(),i=1;e>=i;i++){var n="#"+t+"_cabin_"+i;a>=i?$(n).show():$(n).hide()}object_change_info("change_cabin",t)}function check_error_check_rates(t){var e=!1,a=$("#object_change_"+t).val();if("change_cabin"==a)for(var i=$("#num_cabin_"+t+" option:selected").val(),n=1;i>=n;n++){var o=parseInt($("#"+t+"_type_"+n+" option:selected").val()),r=parseInt($("#"+t+"_adults_"+n+" option:selected").val()),s=parseInt($("#"+t+"_children_"+n+" option:selected").val()),l=parseInt($("#"+t+"_infants_"+n+" option:selected").val());r+s+l>3?($("#"+t+"_errors_"+n).show(),$("#"+t+"_errors_"+n+"_1").show(),$("#"+t+"_errors_"+n+"_2").hide(),$("#"+t+"_errors_"+n+"_3").hide(),e=!0):r+s==0?($("#"+t+"_errors_"+n).show(),$("#"+t+"_errors_"+n+"_2").show(),$("#"+t+"_errors_"+n+"_1").hide(),$("#"+t+"_errors_"+n+"_3").hide(),e=!0):r+s!=1&&3==o&&($("#"+t+"_errors_"+n).show(),$("#"+t+"_errors_"+n+"_3").show(),$("#"+t+"_errors_"+n+"_1").hide(),$("#"+t+"_errors_"+n+"_2").hide(),e=!0)}return e}function object_change_info(t,e){$("#object_change_"+e).val(t);var a=$("#object_change_"+e).val();if("change_cabin"==a){for(var i=$("#num_cabin_"+e+" option:selected").val(),n=0,o=0,r=0,s=1;i>=s;s++)n+=parseInt($("#"+e+"_adults_"+s+" option:selected").val()),o+=parseInt($("#"+e+"_children_"+s+" option:selected").val()),r+=parseInt($("#"+e+"_infants_"+s+" option:selected").val());$("#adults_"+e+" option[value="+n+"]").attr("selected","selected"),$("#children_"+e+" option[value="+o+"]").attr("selected","selected"),$("#infants_"+e+" option[value="+r+"]").attr("selected","selected")}}function get_end_date_of_tour(t,e,a,i,n,o){var r=$(t).val(),s=$(e).val();if(""!=r&&null!=r&&""!=s&&null!=s){s=s.split("-");var l=parseInt($.trim(s[1])),c=parseInt($.trim(s[0]))-1,d=parseInt($.trim(r)),p=new Date(l,c,d);p.setDate(p.getDate()+i);var h=i18n.month_names,u=p.getDate()+" "+h[p.getMonth()]+", "+p.getFullYear(),f="";if("undefined"!=typeof n&&""!=n)for(var _=0;_<n.length;++_){var v=d+"-"+(c+1)+"-"+l;v==n[_]&&(f=" ("+i18n.cruise_upstream+")")}if("undefined"!=typeof o&&o)for(var _=0;_<o.length;++_){var v=d+"-"+(c+1)+"-"+l;v==o[_]&&(f=" ("+i18n.cruise_downstream+")")}u+=f,$(a).html(u)}}function show_tour_detail(t,e){var a="/tour_detail/detail/"+t+".html";window.open(a,"_blank",e)}function show_accomm_detail(t){var e=$("#img_"+t).attr("class");return"togglelink"==e?($("#img_"+t).removeClass("togglelink"),$("#img_"+t).addClass("togglelink_open"),$("#accomm_detail_"+t).show()):($("#img_"+t).removeClass("togglelink_open"),$("#img_"+t).toggleClass("togglelink"),$("#accomm_detail_"+t).hide()),!1}function setAjaxAutocomplete(e,a){$("#destination_ajax_"+e).bind("keydown",function(t){t.keyCode===$.ui.keyCode.TAB&&$(this).data("autocomplete").menu.active&&t.preventDefault()}).autocomplete({minLength:1,autoFocus:!0,source:function(t,i){var n=$.ui.autocomplete.escapeRegex(t.term),o=new RegExp("^"+n,"i"),r=$.grep(a,function(t){return o.test(e.toLowerCase().indexOf("hotel")>=0?t.name:t[1])});i(r)},focus:function(){return!1},select:function(t,a){return $("#destination_ajax_"+e).val(e.toLowerCase().indexOf("hotel")>=0?a.item.name:a.item[1]),!1}}).data("autocomplete")._renderItem=function(a,i){var n,o,r;return e.toLowerCase().indexOf("hotel")>=0?(n=i.name,o=i.region,r=i.parent):(n=i[1],o=i[2],r=i[3]),t="<span style='*float:left; *width:60%'>"+n+"</span>",t=t+"<span style='float:right;*float:left; *width:40%;*display:inline;*text-align: right;'>"+getRegion(o,r)+"</span>",$("<li></li>").data("item.autocomplete",i).append("<a>"+t+"</a>").appendTo(a)},$("#destination_ajax_"+e).autocomplete("widget").removeClass("ui-corner-all")}function getSelectedTourAjax(t){var e=$("#destination_ajax_"+t).val();e=$.trim(e);for(var a=GLOBALS[0],i=0;i<a.length;++i)if(a[i][1]==e)return a[i][0];return null}function getSelectedHotelAjax(t){if(""==$("#destination_ajax_"+t).val())return null;for(var e=0;e<destinations.length;e++)if(destinations[e].name==$("#destination_ajax_"+t).val())return 1==destinations[e].object_type?destinations[e].name:destinations[e].id}function show_block(t,e){var a="#block_search_content_"+e,i="#show_more_"+e,n=$(t).attr("show");"hide"==n?($(t).attr("show","show"),$(a).show(),$(i).show()):($(t).attr("show","hide"),$(a).hide(),$(i).hide())}function show_cruise_detail(t,e){var a="/cruise_detail/detail/"+t;window.open(a,"_blank",e)}function getPriceNumber(t){return t=t.replace("$",""),t=$.trim(t),getFormatNumber(t)}function getFormatNumber(t){return t=t.replace(",",""),Number(t)}function show_booking(t){var e="#"+t+"_img_booking",a="#"+t+"_booking_content",i="#"+t+"_booking_total",n=$(e).attr("src");"/media/btn_mini.gif"==n?(n="/media/btn_mini_hover.gif",$(e).attr("src",n),$(a).show(),$(i).hide()):(n="/media/btn_mini.gif",$(e).attr("src",n),$(a).hide(),$(i).show())}function getTimeLeft(){var t=$("#timeLeft").html();t=t.split(":");var e=$.trim(t[2]),a=$.trim(t[1]),i=$.trim(t[0]);e--,0>e&&(e=(e+60)%60,a--),0>a&&(a=(a+60)%60,i--),0>i&&(i=(i+24)%24),clockID&&(clearTimeout(clockID),clockID=0),t=" "+i+":"+a+":"+e,$("#timeLeft").html(t),clockID=setTimeout("getTimeLeft()",1e3)}function initSearchForm(t,e,a){$('input:radio[name="search_type"]')[0]&&($('input:radio[name="search_type"]')[0].checked=!0),initSearchBox(),initDate(t,e,"#departure_day","#departure_month","#departure_date",a),setAutocomplete(),$("#search_help").tipsy({fallback:$("#search_help_content").val(),gravity:"s",width:"auto",title:i18n.help}),$("#tour_type_help").tipsy({fallback:$("#tour_type_help_content").val(),gravity:"s",width:"auto",title:i18n.help}),$("#destination_help").tipsy({fallback:$("#destination_help_content").val(),gravity:"s",width:"auto",title:i18n.help}),$("#travel_style_help").tipsy({fallback:$("#travel_style_help_content").val(),gravity:"s",width:"auto",title:i18n.help})}function change_search_type(t,e,a,i){var n=$(t).val();2==n?($("#frmSearchForm").css("display","none"),$("#block_hotel_search_form").css("display","block"),$("#search_help").tipsy({fallback:$("#hotel_help").val(),gravity:"s"})):($("#block_hotel_search_form").css("display","none"),$("#frmSearchForm").css("display","block"),$("#destinations").val()==$("#destinations").attr("alt")&&($("#destinations").css("color","#808080"),$("#destinations").css("font-style","italic")),initSearchForm(e,a,i))}function search(t,e){var a=!0,i=get_des_selected_ids();return null!=i&&i.length>0?($("#destination_ids").val(i),$("#is_cruise_port").val(""),void(a&&(check_travel_date($("#departure_date").val(),t),document.frmSearchForm.action=e+getSearchParams(),document.frmSearchForm.submit()))):(alert(i18n.search_destination_required),a=!1,!1)}function getSelectedTravelStyles(){for(var t="",e=0;e<GLOBAL_TRAVEL_STYLE.length;++e)$("#travelstyle_"+e).attr("checked")&&(t=t+GLOBAL_TRAVEL_STYLE[e].name+":");return""!=t&&(t=t.substring(0,t.length-1)),t}function click_book_together(t,e,a){window.location.href="/book-together/"+t+"/"+e+"/"+a+"/"}function back_to_top(){$("html, body").animate({scrollTop:0},"fast")}function go_bottom(){$("html, body").animate({scrollTop:$(document).height()-$(window).height()},"slow")}function go_book_together_position(){$("html, body").animate({scrollTop:$("#booking_together_section").offset().top},"fast")}function show_service(t,e){var a="#"+t+"_img_collapse",i=$(a).attr("src");if("/media/btn_mini.gif"==i){i="/media/btn_mini_hover.gif",$(a).attr("src",i),$("div#"+t).show();var n=$("div#"+t).attr("load");"loaded"!=n&&$.ajax({url:e,type:"POST",data:"",success:function(e){$("div#"+t).html(e),$("div#"+t).attr("load","loaded")}}),$("#"+t+"_button_book").hide(),$(".plus_icon_"+t).show()}else i="/media/btn_mini.gif",$(a).attr("src",i),$("div#"+t).hide(),$("#"+t+"_button_book").show()}function search_more(t,e,a,i){if(void 0!=a){if("hotel"==i)var n=getSelectedHotelAjax(t);else var n=getSelectedTourAjax(t);if(null==n||""==n)return alert(i18n.search_destination_required),$("#destination_ajax_"+t).focus(),!1;$("#destination_id_"+t).val(n)}(void 0==e||""==e)&&(e=$("#form_"+t).attr("action"));var o=$("#form_"+t).serialize(),r="#block_search_content_"+t;$("html, body").animate({scrollTop:$("#block_recommendation_"+t).offset().top},"fast"),showIndicator($("#block_search_result_"+t).length>0?"#block_search_result_"+t:r),$.ajax({url:e,type:"POST",data:o,success:function(t){$(r).html(t)}}),$("#show_more_"+t).css("display","none")}function showIndicator(t){var e="/media/loading-indicator.gif";$(t).html('<div style="width:100%;text-align:center;"><img src="'+e+'"/></div>')}function bt_sort_by(t,e,a){$("#sort_by_"+t).val(e),search_more(t,"","1",a)}function go_check_rate_position(){$("html, body").animate({scrollTop:$("#tabs").offset().top},"fast")}function go_url(t){window.location.href=t}function close_popup(){$("#overlay_popup").hide(),$("#popup_container").hide(),$("#popup_content").html("")}function see_cruise_overview(t,e,a){var i=getCookie("departure_date");null==i||""==i||(e=i),(null==a||void 0==a)&&(a=""),$("#popup_content").html('<center><img alt="" src="http://www.bestpricevn.net/media/loading-indicator.gif"></center>');var n=$(document).scrollTop()+60;$("#popup_container").css("top",n),$("#overlay_popup").show(),$("#popup_container").show(),$.ajax({url:"/cruise_detail/see_overview/",type:"POST",cache:!0,data:{cruise_id:t,departure_date:e,cruise_name:a},success:function(t){$("#popup_content").html(t)}})}function see_more_deals(t,e){$("#popup_content").html('<center><img alt="" src="http://www.bestpricevn.net/media/loading-indicator.gif"></center>');var a=$(document).scrollTop()+80;$("#popup_container").css("top",a),$("#overlay_popup").show(),$("#popup_container").show(),$.ajax({url:"/tour_search/see_more_deals/",type:"POST",cache:!0,data:{tour_id:t,departure_date:e},success:function(t){$("#popup_content").html(t)}})}function see_tour_overview(t,e,a){var i=getCookie("departure_date");null==i||""==i||(e=i),(null==a||void 0==a)&&(a=""),$("#popup_content").html('<center><img alt="" src="http://www.bestpricevn.net/media/loading-indicator.gif"></center>');var n=$(document).scrollTop()+60;$("#popup_container").css("top",n),$("#overlay_popup").show(),$("#popup_container").show(),$.ajax({url:"/tour_search/see_overview/",type:"POST",cache:!0,data:{tour_id:t,departure_date:e,tour_name:a},success:function(t){$("#popup_content").html(t)}})}function see_hotel_overview(t,e,a){var i=getCookie("arrival_date");null==i||""==i||(e=i),(null==a||void 0==a)&&(a=""),$("#popup_content").html('<center><img alt="" src="http://www.bestpricevn.net/media/loading-indicator.gif"></center>');var n=$(document).scrollTop()+60;$("#popup_container").css("top",n),$("#overlay_popup").show(),$("#popup_container").show(),$.ajax({url:"/hotel_detail/see_overview/",type:"POST",cache:!0,data:{hotel_id:t,arrival_date:e,hotel_name:a},success:function(t){$("#popup_content").html(t)}})}function see_destination_overview(t,e,a){var i=getCookie("departure_date");null==i||""==i||(e=i),(null==a||void 0==a)&&(a=""),$("#popup_content").html('<center><img alt="" src="http://www.bestpricevn.net/media/loading-indicator.gif"></center>');var n=$(document).scrollTop()+60;$("#popup_container").css("top",n),$("#overlay_popup").show(),$("#popup_container").show(),$.ajax({url:"/destination/see_overview/",type:"POST",cache:!0,data:{destination_id:t,destination_name:a,departure_date:e},success:function(t){$("#popup_content").html(t)}})}function see_activity_overview(t,e,a){var i=getCookie("departure_date");null==i||""==i||(a=i),(null==e||void 0==e)&&(e=""),$("#popup_content").html('<center><img alt="" src="http://www.bestpricevn.net/media/loading-indicator.gif"></center>');var n=$(document).scrollTop()+60;$("#popup_container").css("top",n),$("#overlay_popup").show(),$("#popup_container").show(),$.ajax({url:"/destination/see_activity_overview/",type:"POST",cache:!0,data:{activity_id:t,activity_name:e,departure_date:a},success:function(t){$("#popup_content").html(t)}})}function show_hide_img(t){var e=$(t).attr("stat");"hide"==e?($(".img_hide").show(),$(t).attr("stat","show"),$(t).html("Show less &laquo;")):($(".img_hide").hide(),$(t).attr("stat","hide"),$(t).html("Show more &raquo;"))}function get_tour_prices_ajax(t,e,a,i,n){if("undefined"!=typeof tour_ids&&""!=tour_ids){var o=getCookie("departure_date");(null==o||""==o)&&(o=t),$.ajax({url:"/vietnam_tours/get_tour_prices/",type:"POST",cache:!0,dataType:"json",data:{tour_ids:tour_ids,departure_date:o},success:function(t){for(var o=0;o<t.length;o++){var r=t[o],s=e+r.f_price;if(0==r.f_price&&(s=n,$("."+r.id+"from_label").html("")),$("."+r.id+"from_price").html(s),$("."+r.id+"from_price").parent().parent().append(a),$("."+r.id+"block_price").show(),0!=r.d_price?($("."+r.id+"promotion_price").html(e+r.d_price),$("."+r.id+"block_pro_price").show()):$("."+r.id+"block_pro_price").hide(),""!=r.text_promotion){for(var l=r.text_promotion.split(","),c=0;c<l.length;++c)$("."+r.id+"text_promotion").append("best_tour"==$("#"+r.id+"_offer_title").attr("rel")?'<li><span class="icon icon_checkmark"></span><a class="special" href="javascript:void(0)" id="promotion_'+r.id+"_"+r.promotion_id+"_"+c+'">'+l[c]+" &raquo;</a></li>":'<li><a class="special" href="javascript:void(0)" id="promotion_'+r.id+"_"+r.promotion_id+"_"+c+'">'+l[c]+" &raquo;</a></li>"),$("#promotion_"+r.id+"_"+r.promotion_id+"_"+c).tiptip({fallback:r.deal_content,gravity:"s",title:r.deal_title,width:"400px"});0==r.is_hot_deal&&("best_tour"==$("#"+r.id+"_offer_title").attr("rel")?$("#"+r.id+"_offer_title").show():$("#"+r.id+"_offer_title").html(i+":")),$("."+r.id+"block_text_promotion").show()}}}})}}function getCookie(t){var e=document.cookie,a=e.indexOf(" "+t+"=");if(-1==a&&(a=e.indexOf(t+"=")),-1==a)e=null;else{a=e.indexOf("=",a)+1;var i=e.indexOf(";",a);-1==i&&(i=e.length),e=unescape(e.substring(a,i))}return e}function getRandomImage(){var t=$("#top-ads a").length,e=Math.floor(Math.random()*t);$("#top-ads a").eq(e).show()}function changeImage(){var t=$("#top-ads a"),e=++ads_index%t.length;$(t.get(e-1)).fadeOut(1e3,function(){$(t).hide(),$(t.get(e)).fadeIn(1500)})}function initGUI(){setInterval(changeImage,7e3),getRandomImage(),jQuery("#divCart").length>0&&$.ajax({url:"getcart/",type:"POST",cache:!1,data:{},success:function(t){$("#divCart").append(t)}}),$.ajax({url:"home/getmobilelink/",type:"POST",cache:!1,data:{},success:function(t){$("#about_bpt").append(t)}})}!function(t){t.fn.tipsy=function(e){return e=t.extend({},t.fn.tipsy.defaults,e),this.each(function(){var a=t.fn.tipsy.elementOptions(this,e);t(this).hover(function(){t.data(this,"cancel.tipsy",!0);var e=t.data(this,"active.tipsy"),i="function"==typeof a.gravity?a.gravity.call(this):a.gravity;e||(ctn='<div class="tipsy">',"title"!=a.title&&(ctn+='<div class="tipsy-title">'+i18n.help+"</div>"),ctn+='<div class="tipsy-inner"/>',ctn+='<div class="tipsy-arrow"><div class="arrow-before"></div><div class="arrow-after"></div></div>',ctn+="</div>",e=t(ctn),""!=a.width&&t(e).css("width",a.width),"i"==i.charAt(0)&&t(e).css("width","auto"),t.data(this,"active.tipsy",e)),e.find(".tipsy-inner")[a.html?"html":"text"](a.fallback),"title"!=a.title&&e.find(".tipsy-title")[a.html?"html":"text"](a.title);var n=t.extend({},t(this).offset(),{width:this.offsetWidth,height:this.offsetHeight});e.get(0).className="tipsy",e.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).appendTo(document.body);var o=e[0].offsetWidth,r=e[0].offsetHeight,s=t(window).scrollLeft(),l=t(window).scrollTop(),c=s+t(window).width(),d=l+t(window).height(),p=n.top+r+25,h=n.left+o+30,u=i.charAt(0);switch(u){case"n":e.find(".tipsy-arrow").addClass("tipsy-arrow-down"),e.find(".tipsy-arrow").removeClass("tipsy-arrow-up"),e.css({top:n.top-r,left:n.left+n.width/2-20});break;case"s":e.find(".tipsy-arrow").addClass("tipsy-arrow-up"),e.find(".tipsy-arrow").removeClass("tipsy-arrow-down"),e.css({top:n.top+n.height+10,left:n.left+n.width/2-20});break;case"e":e.find("img").each(function(){e.find(".tipsy-inner")[a.html?"html":"text"]('<img src="media/loading.gif"> Loading ...'),e.find(".tipsy-arrow").css("display","none"),o=80,t(this).bind("load",function(){o=this.width+20,e.css({top:n.top,left:n.left-o-10}),e.find(".tipsy-arrow").css("display",""),e.find(".tipsy-inner")[a.html?"html":"text"](a.fallback)}).attr("src",t(this).attr("src"))}),e.find(".tipsy-arrow").addClass("tipsy-arrow-right"),e.css({top:n.top,left:n.left-o-10});break;case"w":e.find("img").each(function(){e.find(".tipsy-inner")[a.html?"html":"text"]('<img src="media/loading.gif"> Loading ...'),e.find(".tipsy-arrow").css("display","none"),o=80,t(this).bind("load",function(){o=this.width+20,e.css({top:n.top,left:n.left+n.width+10}),e.find(".tipsy-arrow").css("display",""),e.find(".tipsy-inner")[a.html?"html":"text"](a.fallback)}).attr("src",t(this).attr("src"))}),e.css({top:n.top,left:n.left+n.width+10})}("n"==u||"s"==u)&&(p>=d&&(e.find(".tipsy-arrow").addClass("tipsy-arrow-down"),e.find(".tipsy-arrow").removeClass("tipsy-arrow-up"),e.css("top",n.top-r)),h>=c&&(e.css("left",n.left-o+30),e.find(".tipsy-arrow").css("left",o-30))),a.fade?e.css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:.8}):e.css({visibility:"visible"})},function(){t.data(this,"cancel.tipsy",!1);var e=this;setTimeout(function(){if(!t.data(this,"cancel.tipsy")){var i=t.data(e,"active.tipsy");a.fade?i.stop().fadeOut(function(){t(this).remove()}):i.remove()}},100)})})},t.fn.tipsy.defaults={fade:!1,fallback:"",gravity:"n",html:!0,title:"title"},t.fn.tipsy.elementOptions=function(e,a){return t.metadata?t.extend({},a,t(e).metadata()):a}}(jQuery),function(t){t.fn.tiptab=function(e){var a=jQuery.extend({selected:0,show:"show",hide:"hide",duration:0,type:0,ajaxOptions:{},select:function(){return!0}},e);return this.each(function(){var e=jQuery(this),i=jQuery(this).find(".bpt-tabs"),n='a[href^="#"]',o='a[data-name^="#"]',r=1;i.find("a").removeClass("selected"),i.find("a").each(function(i){if(!t(this).is(n)&&0==a.type){var o=t(this).attr("title").replace(" ","_");t(this).attr("xhr",t(this).attr("href")),t(this).attr("href","#"+o);var r=t("<div>").attr("id",o);e.append(r)}i==a.selected&&(t(this).attr("xhr")&&t.fn.tiptab.loadData(t(this).attr("xhr"),t(this).attr("href"),a),t(this).addClass("selected"))}),1==a.type?i.find(o).each(function(t){var e=jQuery(this);t==a.selected?t>0&&(window.location.hash=e.attr("data-name")):jQuery(e.attr("data-name")).hide()}):i.find(n).each(function(t){var e=jQuery(this);t==a.selected?t>0&&(window.location.hash=e.attr("href")):jQuery(e.attr("href")).hide()}),i.click(function(e){var o=jQuery(e.target),s=!1,l=!0,c=t(o).attr("data-name"),d="href";if(1==a.type&&void 0!==c&&c!==!1&&(d="data-name"),e.preventDefault(),o.is(n)||1==a.type)s=o;else{var p=o.parents(n);p.length&&(s=p)}if(r=t(o).parent().index(),l=a.select(r),!l)return!1;if(s){var h=i.find("a.selected");return t(h).attr(d)==t(o).attr(d)?!1:(h.length?(jQuery(h.removeClass("selected").attr(d))[a.hide](a.duration,function(){}),jQuery(s.attr(d))[a.show](a.duration,function(){}),s.attr("xhr")&&t.fn.tiptab.loadData(s.attr("xhr"),s.attr(d),a),s.addClass("selected")):jQuery(s.addClass("selected").attr(d))[a.show](a.duration,function(){}),t.fn.tiptab.updateHash(s.attr(d)),!1)}});var s=window.location.hash;if(s)if(1==a.type){jQuery(i.find("a").removeClass("selected").attr("data-name")).hide(),jQuery(i.find('a[data-name="'+s+'"]').addClass("selected").attr("data-name")).show();var l=i.find('a[data-name="'+s+'"]');l.attr("xhr")&&t.fn.tiptab.loadData(l.attr("xhr"),l.attr("data-name"),a)}else{jQuery(i.find("a").removeClass("selected").attr("href")).hide(),jQuery(i.find('a[href="'+s+'"]').addClass("selected").attr("href")).show();var l=i.find('a[href="'+s+'"]');l.attr("xhr")&&t.fn.tiptab.loadData(l.attr("xhr"),l.attr("href"),a)}})},t.fn.tiptab.updateHash=function(e){e=e.replace(/^#/,"");var a,i=t("#"+e);i.length&&(a=t("<div></div>").css({position:"fixed",left:0,top:0,visibility:"hidden"}).attr("id",e).appendTo(document.body),i.attr("id","")),document.location.hash=e,i.length&&(a.remove(),i.attr("id",e))},t.fn.tiptab.loadData=function(e,a,i){var n=t("<div>").addClass("txtC").html('<img src="/media/loading-indicator.gif"/>');t(a).empty().append(n);var o="GET",r={};i.ajaxOptions&&i.ajaxOptions.data&&(o="POST",r=i.ajaxOptions.data),t.ajax({type:o,url:e,data:r,success:function(e){t(a).empty().append(e),t(a).find("a").click(function(e){var n=t(this).attr("href"),o=!1;t(this).attr("datatype")&&"no-ajax"==t(this).attr("datatype")&&(o=!0),"javascript:void(0)"==n||o||(e.preventDefault(),t.fn.tiptab.loadData(n,a,i))})}})}}(jQuery),function(t){t.fn.tiptip=function(e){return e=t.extend({},t.fn.tiptip.defaults,e),this.each(function(){var a=t.fn.tiptip.elementOptions(this,e);t(this).click(function(){t.data(this,"cancel.tiptip",!0);var e=t.data(this,"active.tiptip"),i="function"==typeof a.gravity?a.gravity.call(this):a.gravity;e||(ctn='<div class="tiptip">',"title"!=a.title&&(ctn+='<div class="tiptip-title">'+i18n.help+"</div>"),ctn+='<div class="tiptip-inner"/>',btn_close='<span class="box_btn_close">x</span>',footer_close='<span class="btn-close">'+i18n.close+"</span>",ctn+='<div class="tiptip-footer">'+footer_close+"</div>",ctn+=btn_close+"</div>",e=t(ctn),a.autowidth&&(a.fallback.length>=400&&a.fallback.length<=500&&(a.width=500),a.fallback.length<400&&(a.width=300)),""!=a.width&&t(e).css("width",a.width),"i"==i.charAt(0)&&t(e).css("width","auto"),t.data(this,"active.tiptip",e)),e.find(".tiptip-inner")[a.html?"html":"text"](a.fallback),"title"!=a.title&&e.find(".tiptip-title")[a.html?"html":"text"](a.title);var n=t.extend({},t(this).offset(),{width:this.offsetWidth,height:this.offsetHeight});e.get(0).className="tiptip",e.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).appendTo(document.body);var o=e[0].offsetWidth,r=e[0].offsetHeight;e.find(".box_btn_close").click(function(){e.remove()}),e.find(".btn-close").click(function(){e.remove()}),t(document).click(function(a){var i=a?a:event,n=i.srcElement?i.srcElement:i.target;0===e.has(a.target).length&&"javascript:void(0)"!=n&&"tiptip"!=a.target.className&&t(".tiptip").remove()});var s=t(window).scrollTop(),l=s+t(window).height(),c=n.top+r+25,d=Math.round(n.top);switch(i.charAt(0)){case"n":var p=d-r;10>p&&(p=10);var h=n.left-o+this.offsetWidth;if(e.find(".tipsy-arrow").css("display","none"),e.css({top:p,left:h}),s>d-r)if(c>=l){var u=c-l;e.css("top",d-r-u)}else e.css("top",d);break;case"s":e.find(".tipsy-arrow").css("display","none");var p=d+this.offsetHeight,h=n.left-o+this.offsetWidth;if(e.css({top:p,left:h}),c>=l&&d>r)if(s>d-r){var u=s-(d-r);d>u&&e.css("top",d-u)}else e.css("top",d-r);break;case"e":e.css({top:n.top+n.height-35,left:n.left-o-10});break;case"w":e.css({top:n.top+35,left:n.left+n.width/2-20});break;case"c":e.css({top:n.top+35,left:n.left+n.width/2-20});break;case"i":e.css({top:n.top+n.height-35,left:n.left-o-10})
}a.fade?e.css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:.8}):e.css({visibility:"visible"})},function(){})})},t.fn.tiptip.elementOptions=function(e,a){return t.metadata?t.extend({},a,t(e).metadata()):a},t.fn.tiptip.defaults={fade:!1,fallback:"",gravity:"n",html:!0,title:"title",autowidth:!1}}(jQuery);var disabledDays="",month_names=i18n.month_names,daysofweek=i18n.days_of_week,LIMIT_MONTH=18,FAVOURITE_TOURS="favourite_tours",MY_VIEWED_HOTELS="my_viewed_hotels",MY_VIEWED_CRUISES="my_viewed_cruises";Array.indexOf||(Array.prototype.indexOf=function(t){for(var e=0;e<this.length;e++)if(this[e]==t)return e;return-1}),String.replaceAll||(String.prototype.replaceAll=function(t,e){for(var a=this,i=a.indexOf(t);-1!=i;)a=a.replace(t,e),i=a.indexOf(t);return a});var clockID=0,ads_index=0;